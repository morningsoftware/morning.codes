<!doctype html>
<html>
    <head>
        <title>morning.codes</title>
        <link href="/css/output.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script>
            function moveCaret() {
                //TODO: Add caret position logic.
                const input = document.querySelector("input");
                const span = document.querySelector("span");
                const inputLength = input.value.length;
                span.style.transform = `translateX(${inputLength * 0.53 + 1}rem)`;
            }
            var pageLocation = "~";
            function checkKey(event) {
                const input = event.target.value;
                if (event.key === "Enter") {
                    // Check if user is in root directory
                    if (pageLocation === "~") {
                        if (input.toLowerCase() === "cd projects") {
                            pageLocation = "projects";
                            clearInput();
                        } else if (input.toLowerCase() === "cd login") {
                            pageLocation = "login";
                            clearInput();
                        } else if (input.toLowerCase() === "cd 404") {
                            pageLocation = "404";
                            clearInput();
                        } else if (input.toLowerCase() === "ls") {
                            inputMessage(event.target, "projects login 404");
                        } else if (input.toLowerCase().startsWith("cd")) {
                            inputMessage(
                                event.target,
                                "no such file or directory",
                            );
                        } else if (input.toLowerCase().includes("help")) {
                            inputMessage(event.target, "try ls :)");
                        } else {
                            inputMessage(event.target, "command not found");
                        }
                        // Check if user is in projects directory.
                    } else if (pageLocation === "projects") {
                        if (input.toLowerCase() === "cd ..") {
                            pageLocation = "~";
                            clearInput();
                        } else if (input.toLowerCase() === "./projects.html") {
                            window.location.href = "/pages/projects.html";
                        } else {
                            inputMessage(
                                event.target,
                                "no such file or directory",
                            );
                        }
                        // Check if user is in login directory.
                    } else if (pageLocation === "login") {
                        if (input.toLowerCase() === "cd ..") {
                            pageLocation = "~";
                            clearInput();
                        } else {
                            inputMessage(
                                event.target,
                                "no such file or directory",
                            );
                        }
                        // Check if user is in 404 directory.
                    } else if (pageLocation === "404") {
                        if (input.toLowerCase() === "cd ..") {
                            pageLocation = "~";
                            clearInput();
                        } else if (input.toLowerCase() === "ls") {
                            inputMessage(event.target, "404.html");
                        } else if (input.toLowerCase() === "./404.html") {
                            window.location.href = "/404.html";
                        } else {
                            inputMessage(
                                event.target,
                                "no such file or directory",
                            );
                        }
                    }
                }
            }
            function inputMessage(input, message) {
                input.value = message;
                input.style.opacity = 0.5;
                input.disabled = true;
                moveCaret();
                setTimeout(() => {
                    input.value = "";
                    input.style.opacity = 1;
                    input.disabled = false;
                    input.focus();
                    moveCaret();
                }, 2000);
            }
            function clearInput() {
                const input = document.querySelector("input");
                input.value = "";
                input.focus();
            }
            document.addEventListener("DOMContentLoaded", function () {
                const input = document.querySelector("input");
                input.focus();
            });
        </script>
    </head>
    <body
        class="flex font-mono justify-center items-center h-screen bg-gray-950 text-emerald-50 text-sm p-2"
    >
        <div class="text-left">
            <h1>Hey, I'm morning. I make stuff.</h1>
            <h1 class="flex items-center">
                âžœ
                <input
                    class="appearance-none bg-transparent border-none w-full text-emerald-50 py-1 px-2 leading-tight focus:outline-none caret-transparent"
                    type="text"
                    placeholder=""
                    aria-label="Search the system!"
                    maxlength="15"
                    oninput="moveCaret()"
                    onclick="moveCaret()"
                    onkeyup="moveCaret()"
                    onkeydown="checkKey(event)"
                />
                <span
                    name="caret"
                    class="absolute animate-flash text-emerald-50 translate-x-4 bg-green-400"
                    >&nbsp
                </span>
            </h1>
        </div>
    </body>
</html>
